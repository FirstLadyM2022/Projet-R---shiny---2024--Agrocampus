theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d()
)
summarise(concentration_dep = mean(concentration_moy))
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Calcul concentration par département et par année
nitrate_trend_dep <- nitrate_dep %>%
summarise(concentration_dep = mean(concentration_moy))
summarise(concentration_dep = mean(concentration_moy))
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement))
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement))
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement))
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line()
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line())
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
# Plot
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line()) +
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d()
nitrate_dep <- data
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy)
nitrate_dep
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_dep
annee
nitrate_dep %>%
group_by(annee, groups(libelle_departement)
nitrate_trend_dep <- nitrate_dep %>%
# Calcul concentration par département et par année
Tend_dep <- nitrate_dep %>%
group_by(annee, libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
Tend_dep <- nitrate_dep %>%
group_by(annee, libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
Tend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement)) %>%
summarise(concentration_dep = mean(concentration_moy))
# Select relevant columns and remove missing values
nitrate_data <- nitrate_data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
data <- read.csv("/Users/massambadiop/Documents/INSTITUT AGRO/M2 Sciences des données/Analyse de données massives sur R/Projet-R---shiny---2024--Agrocampus-1/qualite-des-cours-deau-vis-a-vis-des-nitrates-en-bretagne.csv",stringsAsFactors  = T,header =T)
nitrate_data <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_trend_dept <- nitrate_data %>%
group_by(annee, libelle_departement) %>%
summarise(mean_concentration = mean(concentration_moy))
# Select relevant columns and remove missing values
nitrate_data <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Group data by year and department to calculate the average nitrate concentration
nitrate_trend_dept <- nitrate_data %>%
group_by(annee, libelle_departement) %>%
summarise(mean_concentration = mean(concentration_moy))
# Plot nitrate concentration trends by department using ggplot2
ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d()
# Select relevant columns and remove missing values
nitrate_data <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Group data by year and department to calculate the average nitrate concentration
nitrate_trend_dept <- nitrate_data %>%
group_by(annee, libelle_departement) %>%
summarise(mean_concentration = mean(concentration_moy))
# Plot nitrate concentration trends by department using ggplot2
ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right")
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right"))
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis_c()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis_d()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis_d()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_c())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_b())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_abline() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_hline() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
e
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
data <- data %>%
select(annee, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Concentration en nitrate par année
Tend <- data %>%
group_by(annee) %>%
summarise(concentration_moy = mean(concentration_moy))
# Plot concentration en nitrate
ggplotly(ggplot(Tend, aes(x = annee, y = concentration_moy)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Evolution de la concentration en nitrates dans le temps",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)") +
theme_gray())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() + geom_point()
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point(size=0.2) +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point(size=1) +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point(size=0.7) +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Load necessary libraries
library(shiny)
runApp('ShiNitrate/Shinytrate')
shiny::runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
shiny::runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
d <- highlight_key(mtcars)
qplot(data = d, x = mpg, y = wt)
d <- highlight_key(mtcars)
qplot(data = d, x = mpg, y = wt) %>%
subplot(qplot(data = d, x = mpg, y = vs)) %>%
layout(title = "Click and drag to select points") %>%
highlight("plotly_selected")
d <- highlight_key(mtcars)
qplot(data = d, x = mpg, y = wt) %>%
subplot(qplot(data = d, x = mpg, y = vs))
library(tidyverse)
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate')
d <- highlight_key(mtcars)
qplot(data = d, x = mpg, y = wt) %>%
subplot(qplot(data = d, x = mpg, y = vs)) %>%
layout(title = "Click and drag to select points") %>%
highlight("plotly_selected")
runApp('ShiNitrate')
runApp('ShiNitrate')
# Installer les packages si nécessaire
# install.packages("shiny")
# install.packages("leaflet")
# install.packages("ggfortify")
install.packages("bslib")
install.packages("bslib")
runApp('ShiNitrate')
shiny::runApp('ShiNitrate')
install.packages("shinythemes")
install.packages("shinythemes")
install.packages("shinythemes")
install.packages("shinythemes")
install.packages("shinythemes")
install.packages("shinythemes")
install.packages("shinythemes")
runApp('ShiNitrate/Shinytrate')
library(shiny); runApp('C:/Users/mirei/Desktop/projet_du_5_10_2024/évolution_temporelle_des_concentrations.R')
runApp('évolution_temporelle_des_concentrations.R')
runApp('Comparaions_entre_Région_de_la_concentration_de_nitrtate.R')
runApp('Comparaions_entre_Région_de_la_concentration_de_nitrtate.R')
runApp('Comparaions_entre_Région_de_la_concentration_de_nitrtate.R')
repo <- repository("C:/Users/mirei/Desktop/Projet-R---shiny---2024--Agrocampus")
install.packages("git2r")
library(git2r)
repo <- repository("C:/Users/mirei/Desktop/Projet-R---shiny---2024--Agrocampus")
commits <- commits(repo)
print(commits)  # Affiche tous les commits avec leurs numéros SHA
repo <- repository("C:/Users/mirei/Desktop/Projet-R---shiny---2024--Agrocampus")
# Remplace "sha_commit" par le numéro SHA du commit voulu et "nom_du_fichier" par le nom du fichier
checkout(repo, path = "évolution_temporelle_des_concentrations.R", commit = lookup_commit(repo, "adc621aa1939f071b5bf9538d8678f56a7110597"))
push(repo, refspec = "refs/heads/main", force = TRUE)
commits <- commits(repo)
print(commits)  # Affiche tous les commits avec leurs numéros SHA
library(shiny); runApp('Comparaions_entre_Région_de_la_concentration_de_nitrtate.R')
runApp('evolution_nombre_de_stations_de_prélèvement')
runApp('évolution_site_prélèvement.R')
runApp('évolution_site_prélèvement_dptement.R')
runApp('évolution_site_prélèvement_dptement.R')
runApp('évolution_site_prélèvement_dptement.R')
runApp('Comparaions_entre_Région_de_la_concentration_de_nitrtate.R')
View(nitrate_dep)
df <- read.csv("qualite-des-cours-deau-vis-a-vis-des-nitrates-en-bretagne.csv")
runApp('prédiction_concentration_moy.R')
runApp('prédiction_concentration_moy.R')
runApp('ShiNitrate')
runApp('ShiNitrate')
install.packages("shinythemes")
library(shinythemes)
runApp('ShiNitrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
rm(list = ls())
runApp('évolution_site_prélèvement_dptement.R')
runApp('ShiNitrate')
runApp('ShiNitrate')
runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
runApp('ShiNitrate/Shinytrate')
library(readr)
ecological <- read_delim("C:/Users/mirei/Desktop/Année 2024.2025/Cours Francois Husson/cours gestion des données manquantes/ecological.csv",
delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ","),
trim_ws = TRUE)
View(ecological)
library(readr)
library(dplyr)
library(tidyverse)
library(skimr)
library(summarytools)
library(visdat)
library(funModeling)
library(dlookr)
library(ggplot2)
library(missForest)
install.packages("missForest")
dfSummary(ecological) %>% view()
aggr(Ecolo)
## Delete species with missing values
dim(na.omit(ecological)) # only 72 remaining species!
#visualisation des données
vis_dat(ecological)
vis_miss(ecological)
plot_num(ecological)
library(readr)
Maternal_Health_Risk_Data_Set <- read_csv("~/maternal+health+risk/Maternal Health Risk Data Set.csv")
View(Maternal_Health_Risk_Data_Set)
## Delete species with only missing values for contiuous variables
ind <- which(rowSums(is.na(Ecolo[,-1])) == 6)
ecolo <- read_delim("C:/Users/mirei/Desktop/Année 2024.2025/Cours Francois Husson/cours gestion des données manquantes/ecological.csv",
delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ","),
trim_ws = TRUE)
View(ecolo)
don <- read.table("http://factominer.free.fr/missMDA/ozoneNA.csv",header=TRUE,sep=",",row.names=1, stringsAsFactors = TRUE)
WindDirection <- don[,12]
don <- don[,1:11]           #### keep the continuous variables
View(don)
######################################################
#### Visualization of the pattern of missing values
######################################################
library(VIM)
aggr(don)
aggr(don,only.miss=TRUE,sortVar=TRUE)
res <- summary(aggr(don,prop=TRUE,combined=TRUE))$combinations
res[rev(order(res[,2])),]
matrixplot(don,sortby=2)
marginplot(don[,c("T9","maxO3")])
# Creation of a categorical data set with "o" when observed and "m" when missing
mis.ind <- matrix("o",nrow=nrow(don),ncol=ncol(don))
mis.ind[is.na(don)] <- "m"
dimnames(mis.ind) <- dimnames(don)
mis.ind
# Performing a multiple correspondence analysis to visualize the association
library(FactoMineR)
resMCA <- MCA(mis.ind)
# Performing a multiple correspondence analysis to visualize the association
library(FactoMineR)
resMCA <- MCA(mis.ind)
plot(resMCA,invis="ind",title="MCA graph of the categories")
resMCA <- MCA(mis.ind)
plot(resMCA,invis="ind",title="MCA graph of the categories")
###############################################
#### EM algorithm to estimate mu and Sigma ####
###############################################
library(norm)
pre <- prelim.norm(as.matrix(don))
thetahat <- em.norm(pre)
getparam.norm(pre,thetahat)
## Single imputation using a draw from a normal distribution
library(norm)
pre <- prelim.norm(as.matrix(don))
thetahat <- em.norm(pre)
rngseed(123)           ### must be done!
imp <- imp.norm(pre,thetahat,don)
View(imp)
## Single imputation with PCA
library(missMDA)
nb <- estim_ncpPCA(don)
nb$ncp
plot(0:5,nb$criterion,xlab="dim",ylab="MSEP")
res.comp <- imputePCA(don,ncp=2)
res.comp$completeObs
library(readr)
qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne <- read_csv("test_classe/qualite-des-cours-deau-vis-a-vis-des-nitrates-en-bretagne.csv")
View(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne)
names(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne)
names(data[1 , 2]
)
names(data["libelle_region"])
names(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne["libelle_region"])
names(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne[1])
names(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne[1, 2])
names(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne[ c(1, 2])
names(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne[ c(1, 2)]
)
names(qualite_des_cours_deau_vis_a_vis_des_nitrates_en_bretagne[ 20:26])
