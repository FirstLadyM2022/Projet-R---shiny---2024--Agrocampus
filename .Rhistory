install.packages("tidyverse")
install.packages("lubridate")
install.packages("tidyverse")
install.packages("zoo")
install.packages("forecast")
# Load libraries
library(tidyverse)
library(lubridate)
library(zoo)
library(forecast)
data <- data %>%
select(annee, concentration_moy) %>%
filter(!is.na(concentration_moy)
# Concentration en nitrate par année
nitrate_trend <- nitrate_data %>%
Tend <- data %>%
group_by(annee) %>%
summarise(mean_concentration = mean(concentration_moy))
Tend
plot(Tend)
plot(Tend, pch=16)
# Concentration en nitrate par année
Tend <- data %>%
group_by(annee) %>%
summarise(concentration_moy = mean(concentration_moy))
plot(Tend, pch=16)
library(ggfortify)
# Plot concentration en nitrate
ggplot(Tend, aes(x = annee, y = concentration_moy)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Evolution de la concentration en nitrates dans le temps",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)") +
theme_gray()
# Plot concentration en nitrate
ggplotly(ggplot(Tend, aes(x = annee, y = concentration_moy)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Evolution de la concentration en nitrates dans le temps",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)") +
theme_gray())
library(plotly)
# Plot concentration en nitrate
ggplotly(ggplot(Tend, aes(x = annee, y = concentration_moy)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Evolution de la concentration en nitrates dans le temps",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)") +
theme_gray())
Tend
data_ts <- ts(Tend$concentration_moy, start = min(Tend$annee), frequency = 1)
data_ts
# Decompose en tendance et saisonnalité
data_decomposed <- decompose(data_ts)
data <- data %>%
select(annee, libelle_departement, concentration_moy_dep) %>%
filter(!is.na(concentration_moy))
data <- data %>%
select(annee, libelle_departement, concentration_moy_dep) %>%
filter(!is.na(concentration_moy))
nitrate_dep <- nitrate_data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Group data by year and department to calculate the average nitrate concentration
nitrate_trend_dept <- nitrate_dep %>%
group_by(annee, libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Group data by year and department to calculate the average nitrate concentration
nitrate_trend_dept <- nitrate_dep %>%
group_by(annee, libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_dep
# Group data by year and department to calculate the average nitrate concentration
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
group_by(annee, groups(libelle_departement) %>%
nitrate_trend_dep
# Plot nitrate concentration trends by department using ggplot2
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
# Calcul concentration par département et par année
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement ",
ggplotly(
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep, color = libelle_departement) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement ",
x = "Année",
y = " Concentration moyenne en nitrates (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(
ggplotly(
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep, color = libelle_departement) +
geom_line()
ggplotly(
ggplotly(
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep, color = libelle_departement) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement",
x = "Année"
ggplotly(
# Plot nitrate concentration trends by department using ggplot2
ggplotly(
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep, color = libelle_departement) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement", x= "Année",
y= " Concentration moyenne en nitrates (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
)
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep, color = libelle_departement) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement", x= "Année",
y= " Concentration moyenne en nitrates (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement",
x = "Année",
y = " Concentration moyenne en nitrates (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep, color = libelle_departement) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement",
x = "Année",
y = " Concentration moyenne en nitrates (mg/L)",
color = Department) +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(
ggplot(nitrate_trend_dep,
aes(x = annee, y = concentration_dep, color = libelle_departement) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par departement",
x = "Année",
y = " Concentration moyenne en nitrates (mg/L)",
color = libelle_departement) +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(
# Plot nitrate concentration trends by department using ggplot2
ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d()
)
summarise(concentration_dep = mean(concentration_moy))
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Calcul concentration par département et par année
nitrate_trend_dep <- nitrate_dep %>%
summarise(concentration_dep = mean(concentration_moy))
summarise(concentration_dep = mean(concentration_moy))
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement))
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement))
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement))
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line()
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line())
nitrate_trend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
# Plot
ggplotly( ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line()) +
ggplot(nitrate_trend_dep, aes(x = annee, y = concentration_dep, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d()
nitrate_dep <- data
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy)
nitrate_dep
nitrate_dep <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_dep
annee
nitrate_dep %>%
group_by(annee, groups(libelle_departement)
nitrate_trend_dep <- nitrate_dep %>%
# Calcul concentration par département et par année
Tend_dep <- nitrate_dep %>%
group_by(annee, libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
Tend_dep <- nitrate_dep %>%
group_by(annee, libelle_departement) %>%
summarise(concentration_dep = mean(concentration_moy))
Tend_dep <- nitrate_dep %>%
group_by(annee, groups(libelle_departement)) %>%
summarise(concentration_dep = mean(concentration_moy))
# Select relevant columns and remove missing values
nitrate_data <- nitrate_data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
data <- read.csv("/Users/massambadiop/Documents/INSTITUT AGRO/M2 Sciences des données/Analyse de données massives sur R/Projet-R---shiny---2024--Agrocampus-1/qualite-des-cours-deau-vis-a-vis-des-nitrates-en-bretagne.csv",stringsAsFactors  = T,header =T)
nitrate_data <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
nitrate_trend_dept <- nitrate_data %>%
group_by(annee, libelle_departement) %>%
summarise(mean_concentration = mean(concentration_moy))
# Select relevant columns and remove missing values
nitrate_data <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Group data by year and department to calculate the average nitrate concentration
nitrate_trend_dept <- nitrate_data %>%
group_by(annee, libelle_departement) %>%
summarise(mean_concentration = mean(concentration_moy))
# Plot nitrate concentration trends by department using ggplot2
ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d()
# Select relevant columns and remove missing values
nitrate_data <- data %>%
select(annee, libelle_departement, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Group data by year and department to calculate the average nitrate concentration
nitrate_trend_dept <- nitrate_data %>%
group_by(annee, libelle_departement) %>%
summarise(mean_concentration = mean(concentration_moy))
# Plot nitrate concentration trends by department using ggplot2
ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right")
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Nitrate Concentration Trends by Department",
x = "Year",
y = "Average Nitrate Concentration (mg/L)",
color = "Department") +
theme_minimal() +
theme(legend.position = "right"))
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis_c()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis_d()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")) + scale_color_viridis_d()
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_c())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_b())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_abline() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_hline() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
e
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
data <- data %>%
select(annee, concentration_moy) %>%
filter(!is.na(concentration_moy))
# Concentration en nitrate par année
Tend <- data %>%
group_by(annee) %>%
summarise(concentration_moy = mean(concentration_moy))
# Plot concentration en nitrate
ggplotly(ggplot(Tend, aes(x = annee, y = concentration_moy)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Evolution de la concentration en nitrates dans le temps",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)") +
theme_gray())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() + geom_point()
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
scale_color_viridis_d())
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right") +
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point() +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point(size=0.2) +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point(size=1) +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Plot nitrate concentration trends by department using ggplot2
ggplotly(ggplot(nitrate_trend_dept, aes(x = annee, y = mean_concentration, color = libelle_departement)) +
geom_line() +
geom_point(size=0.7) +
labs(title = "Evolution de la Concentration moyenne en nitrates par Department",
x = "Année",
y = "Concentration moyenne en nitrates (mg/L)",
color = "Departments") +
theme_minimal() +
theme(legend.position = "right")
)
# Load necessary libraries
library(shiny)
runApp('ShiNitrate/Shinytrate')
shiny::runApp('ShiNitrate')
runApp('ShiNitrate/Shinytrate')
